      FUNCTION GAMMB(W,T,TAU1,TAU2)
      IMPLICIT REAL (A-H,O-Z)
      DATA HK/7.638967E-12/,PI/3.141592654/
cfix ,TAU10/0./,TAU20/0./    367.
C        NOTE. HK = 1.05459e-27/1.38054e-16
cfix  IF (TAU1.NE.TAU10) GO TO 10
cfix  IF (TAU2.EQ.TAU20) GO TO 20
cfix 10   CONTINUE
      TAU12=TAU1*TAU1
      TAU22=TAU2*TAU2
      HBH = 0.5*HK/T
      Z2=SQRT ( TAU22 + HBH**2) / TAU1
cfix  TAU10 = TAU1
cfix  TAU20=TAU2
cfix 20   CONTINUE
      WSQR=W*W
      Z = SQRT (1.+ WSQR*TAU12) * Z2
C        COMPUTE THE MODIFIED BESSEL FUNCTION OF THE SECOND KIND (K1)
C        USING AN UNPUBLISHED APPROXIMATION GIVEN BY  COHEN.
      F=1.5707963*(Z+0.5616)/(Z+0.4619)
      BK1=SQRT(1.+Z*F)
      BK1=BK1*EXP(-Z)
      GAMMA=TAU1/PI*EXP(TAU2/TAU1+HBH*W)*BK1 / (1.+WSQR*TAU12)
      GAMMB=GAMMA
      RETURN
      END
