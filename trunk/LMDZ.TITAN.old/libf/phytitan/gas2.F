      SUBROUTINE GAS2(J,K,T,P,U,TAUGAS)
#include "dimensions.h"
      PARAMETER(NLAYER=llm,NLEVEL=NLAYER+1)
      COMMON /STRATO/ C2H2(NLAYER),C2H6(NLAYER)
      COMMON /STRAT2/ HCN(NLAYER)
      DIMENSION A(18),A1(18),A2(18),B(18),B1(18),B2(18)
      DIMENSION C(18),C1(18),C2(18)
      DIMENSION AHCN(11),A1HCN(11),A2HCN(11),BHCN(11),B1HCN(11)
      DIMENSION B2HCN(11),CHCN(11),C1HCN(11),C2HCN(11)
      DATA P0/0.1/

C P0 IS THE REFERENCE PRESSURE USED IN FORMULA
C PRESSURE IS IN BARS!!! ??FLAG?
C U IS IN MOLECULES PER CM2

      DATA a /
     &-58.07850,-73.66951,-22.00411,-26.61158,-27.04048,-25.84024,
     &  0.00000,-18.70291,-16.08370,-23.03309,-31.18288,-19.96538,
     &-24.37518,-17.94444,  0.00000,-17.46335,-20.93769,-10.74428/
      DATA a1/
     & 31.24782, 45.09350,  3.53728,  7.34218,  7.09808,  5.35252,
     &  0.00000,  1.58486, -2.62994,  2.88087, 11.38614,  0.33491,
     &  3.36078, -3.94288,  0.00000, -1.57041,  0.28770,-10.54978/
      DATA a2/
     & -6.15763, -9.47812, -0.72611, -1.73805, -1.65804, -1.23760,
     &  0.00000, -0.33713,  0.84310, -0.44196, -2.79135,  0.00277,
     & -0.60197,  1.27842,  0.00000,  0.37686,  0.08828,  2.77701/
      DATA b/
     &  5.27820,  2.66675,  1.31741, -5.05287,  1.88008,  4.49298,
     &  0.00000, -0.94667,  2.77477, 15.80634, 33.83065, -2.29512,
     &  2.90790,  0.77265,  0.00000, -0.95471,  3.30490,  0.43886/
      DATA b1/
     & -4.00372, -1.49356, -0.80081,  5.86571, -0.95994, -3.38754,
     &  0.00000,  1.24800, -1.75869,-13.07462,-29.97486,  2.67427,
     & -1.73763,  0.87904,  0.00000,  1.35597, -2.09025,  1.40393/
      DATA b2/
     &  0.81995,  0.32331,  0.16170, -1.42280,  0.26043,  0.87377,
     &  0.00000, -0.31593,  0.36935,  2.86686,  6.83669, -0.75690,
     &  0.24220, -0.46079,  0.00000, -0.42681,  0.32905, -0.61443/
      DATA c/
     & -8.99733,  6.51736, -0.54907, -4.80457,  2.83010, -2.12019,
     &  0.00000, -1.53211,-13.48286,-18.91273,-16.89597, -1.02362,
     &  0.25710, -6.27612,  0.00000, -0.56746,  0.14651, -8.53711/
      DATA c1/
     &  8.43865, -6.62977,  0.48722,  4.43910, -3.21534,  1.92581,
     &  0.00000,  1.33927, 12.54849, 17.74174, 14.03467,  0.84636,
     & -0.30260,  5.98928,  0.00000,  0.40909, -0.17410,  8.13665/
      DATA c2/
     & -1.99052,  1.64435, -0.13150, -1.02683,  0.80781, -0.49989,
     &  0.00000, -0.30569, -2.91842, -4.14473, -2.91521, -0.18050,
     &  0.06981, -1.43493,  0.00000, -0.07578,  0.03729, -1.93800/

      DATA ahcn/
     & -33.41732,-35.36144,-19.76105,-16.45201,-13.09335,-18.84868,
     &   0.00000,-18.605,  -13.479,  -20.717,  -17.126/
      DATA a1hcn/
     &  11.42543, 12.36695,  2.43240, -2.78746, -6.36678, -0.49211,
     &   0.00000,  1.0009,  -4.9550,   2.0424,  -2.0131/
      DATA a2hcn/
     &  -2.20538, -2.46746, -0.66486,  0.78681,  1.54548, -0.05627,
     &   0.00000, -0.33381,  1.0814,  -0.73052,  0.24167/
      DATA bhcn/
     &  -1.14762,  0.90664,  1.02184, -0.33594, -3.11059, -2.64450,
     &   0.00000, -0.66681, -5.9630,  -1.7662,  -1.6016/
      DATA b1hcn/
     &   2.24061,  0.49483, -0.80223,  1.42836,  4.46001,  4.38418,
     &   0.00000,  0.88177,  6.7881,   2.8273,   2.6971/
      DATA b2hcn/
     &  -0.69153, -0.23858,  0.21351, -0.45182, -1.19719, -1.21663,
     &   0.00000, -0.20593, -1.6747,  -0.70656, -0.62399/
      DATA chcn/
     &  -0.41463,  5.42790,  1.78780, -0.84225, -3.68653,  4.96968,
     &   0.00000,  0.46294, -5.4664,   3.1475,  -2.2176/
      DATA c1hcn/
     &   0.35005, -5.78523, -2.04583,  0.78874,  2.98507, -6.43269,
     &   0.00000, -0.69540,  5.1038,  -4.0865,   1.5738/
      DATA c2hcn/
     &  -0.08749,  1.48015,  0.54974, -0.19827, -0.60826,  1.84860,
     &   0.00000,  0.19795, -1.1936,   1.1768,  -0.30869/

       IF (K .GT. 11) THEN
          XKV =         A(K) + A1(K)*LOG10(T) + A2(K)*LOG10(T)**2
     &   + LOG10(P/P0)*(B(K) + B1(K)*LOG10(T) + B2(K)*LOG10(T)**2)
     &   +             (C(K) + C1(K)*LOG10(T) + C2(K)*LOG10(T)**2)
     &    *LOG10(P/P0)**2
          XKV=10.**XKV
C CLIP OUT THE CLEAR INTERVALS.
          IF (A(K) .EQ. 0.0) XKV=0.0
          TAUGAS=U*C2H6(J)*XKV
       ELSE
          XKV =         A(K) + A1(K)*LOG10(T) + A2(K)*LOG10(T)**2
     &   + LOG10(P/P0)*(B(K) + B1(K)*LOG10(T) + B2(K)*LOG10(T)**2)
     &   +             (C(K) + C1(K)*LOG10(T) + C2(K)*LOG10(T)**2)
     &    *LOG10(P/P0)**2
          XKV=10.**XKV
          IF (A(K) .EQ. 0.0) XKV=0.0
          TAUGAS=U*C2H2(J)*XKV
          XKVhcn =   Ahcn(K) + A1hcn(K)*LOG10(T) + A2hcn(K)*LOG10(T)**2
     &+ LOG10(P/P0)*(Bhcn(K) + B1hcn(K)*LOG10(T) + B2hcn(K)*LOG10(T)**2)
     &+             (Chcn(K) + C1hcn(K)*LOG10(T) + C2hcn(K)*LOG10(T)**2)
     & *LOG10(P/P0)**2
          XKVhcn=10.**XKVhcn
          IF (Ahcn(K) .EQ. 0.0) XKVhcn=0.0
          TAUGAShcn=U*HCN(J)*XKVhcn

c          if(j.eq.25) then
c           print*,'J=',j,' P=',P,' HCN=',HCN(J),taugashcn,
c     &' C2H2=',C2H2(J),taugas,' K=',K
c          endif

          taugas = taugas+taugashcn

       ENDIF
       RETURN
       END
